# 用于展示给用户的标题
title: MariaDB - Code Execution
# 漏洞编号（CVE/CAN/BUGTRAQ/CNCVE/CNVD/CNNVD...）
number: CVE-2021-27928
# 漏洞类型：从以下类型中选取
# 资源开发：Resource Development
# 初始访问：Initial Access
# 执行：Execution
# 持久控制：Persistence
# 提权：Privilege Escalation
# 绕过防御：Defense Evasion
# 凭证访问：Credential Access
# 发现：Discovery
# 横向渗透：Lateral Movement
# 信息收集：Collection
# 命令控制：Command and Control
# 信息盗取：Exfiltration
# 造成的影响：Impact
type: Execution
# 漏洞评分
score: 8.2
# 目标类型
target: 
  # 目标可在此操作系统运行
  os: 
    Windows: true
    AIX: true
    Linux: true
    Solaris: true
    BSD: true
    UNIX: true
    VxWorks: false
  # 目标所属应用程序类别
  app:
    web: false
    E-mail: false
    FTP: false
    database: true
    middleware: false
    other: ~
  # 目标是否可存在于硬件防火墙、入侵检测系统、路由器和交换机
  hardware:
    Firewall: true
    IDS: true
    router: true
    switch: true
  # 目标如果属于数据库，对应数据库产品
  Oracle: false
  MySQL: false
  SQL Server: false
  DM7: false
  DM8: false
  DB2: false
  Informix: false
  Gbase: false
  PostgreSQL: false
  SQLlite: false
  MariaDB: true
  MS-SQL: false

# 对漏洞的描述
vul_description: MariaDB 10.2.37 版本之前的 10.2 版本，10.3.28 版本之前的 10.3 版本，10.4.18 版本之前的 10.4 版本和 10.5.9 版本之前的 10.5 版本存在代码注入漏洞，不受信任的搜索路径会导致eval注入
# 对漏洞利用效果的描述
exp_effect: 执行任意代码或系统命令
# 漏洞影响的版本范围（格式要求：软件名 版本号）
affect_version: MariaDB:10.2.0-10.2.36/10.3.0-10.3.27/10.4.0-10.4.17/10.5.0-10.5.8
# 脚本来源
source: https://www.exploit-db.com/exploits/49765
# 来源认定漏洞危险等级
level: HIGH
# 脚本语言
language: 
  Ruby: false
  Perl: false
  Python: false
  PHP: false
  Java: false
  JavaScript: false
  other: ~
# 环境依赖
dependence: bash 5.1.16
# 脚本存储路径(相对路径)
path: poc/poc.sh
# 备注（运行方式或任何提示）
help: |-  #给出运行示例命令行(Example)+具体的帮助信息(Usage)
  Example: 
    ./poc/poc.sh
  Usage: 
    ./poc/poc.sh
    # 会提示输入目标IP
    # 需要先开启nc监听再执行poc
    